# ===================================
# VESTA API - Main Configuration
# ===================================
# This is the main configuration file.
# Profile-specific settings are in application-{profile}.properties

# === SPRING PROFILES ===
# Active profile: dev (local development) or prod (production/Docker)
spring.profiles.active=${SPRING_PROFILES_ACTIVE:dev}

# === APPLICATION INFO ===
spring.application.name=vesta-api
server.port=${SERVER_PORT:8080}

# === BASE DE DATOS ===
spring.datasource.url=${SPRING_DATASOURCE_URL:jdbc:postgresql://localhost:5433/vesta_db}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:vesta_user}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:vesta_password}
spring.datasource.driver-class-name=org.postgresql.Driver

# === JPA / HIBERNATE ===
spring.jpa.hibernate.ddl-auto=${HIBERNATE_DDL_AUTO:update}
spring.jpa.show-sql=${JPA_SHOW_SQL:true}
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect

# Enable JPA Auditing
spring.jpa.properties.hibernate.enable_lazy_load_no_trans=true

# === SEGURIDAD JWT ===
jwt.secret=${JWT_SECRET:ClaveSecretaSuperSeguraParaVestaProyecto2025}
jwt.expiration=${JWT_EXPIRATION:86400000}

# === MULTIPART ===
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB

# === LOGGING ===
logging.level.root=${LOGGING_LEVEL_ROOT:INFO}
logging.level.com.vesta=${LOGGING_LEVEL_COM_VESTA:DEBUG}

# === EMAIL CONFIGURATION ===
# Gmail SMTP configuration for password recovery
# IMPORTANTE: Para usar Gmail, necesitas generar una "Contraseña de Aplicación"
# 1. Ve a https://myaccount.google.com/security
# 2. Activa "Verificación en dos pasos"
# 3. Busca "Contraseñas de aplicaciones"
# 4. Genera una contraseña para "Correo" -> "Vesta App"
# 5. Usa esa contraseña (16 caracteres sin espacios) en MAIL_PASSWORD
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=${MAIL_USERNAME:tu-email@gmail.com}
spring.mail.password=${MAIL_PASSWORD:tu-contraseña-de-aplicacion}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.ssl.trust=smtp.gmail.com
spring.mail.properties.mail.smtp.connectiontimeout=5000
spring.mail.properties.mail.smtp.timeout=5000
spring.mail.properties.mail.smtp.writetimeout=5000

# Remitente del email (debe coincidir con MAIL_USERNAME)
app.mail.from=${MAIL_USERNAME:tu-email@gmail.com}

# Frontend URL for password reset links
app.frontend.url=${FRONTEND_URL:http://localhost}

# === SMS CONFIGURATION (Twilio) ===
# Twilio credentials for SMS password recovery
twilio.account.sid=${TWILIO_ACCOUNT_SID:}
twilio.auth.token=${TWILIO_AUTH_TOKEN:}
twilio.messaging.service.sid=${TWILIO_MESSAGING_SERVICE_SID:}

# SMS configuration
sms.enabled=${SMS_ENABLED:true}

# === SCHEDULING ===
spring.task.scheduling.enabled=true

# === ACTUATOR / HEALTH CHECK ===
# Disable mail health check to avoid 503 errors when SMTP is not configured
management.health.mail.enabled=false
