type: collection.insomnia.rest/5.0
schema_version: "5.1"
name: Vesta API
meta:
  id: wrk_c6cf34706c764ce28dc0c272bf0b8e74
  created: 1764837783560
  modified: 1764837783560
  description: ""
collection:
  - name: 1. Autenticación
    meta:
      id: fld_016addbda415461c826b7ef435eb739c
      created: 1764837783635
      modified: 1764837783635
      sortKey: -1764837783635
      description: ""
    children:
      - url: "{{ base_url }}/api/auth/register"
        name: Registro de Usuario
        meta:
          id: req_7968bef4104e4d8d8db32c6bbb7abb39
          created: 1701600000000
          modified: 1701600000000
          isPrivate: false
          description: ""
          sortKey: -100
        method: POST
        body:
          mimeType: application/json
          text: |-
            {
            	"nombreCompleto": "Javier Oliver",
            	"movil": "+34600123456",
            	"correoElectronico": "javi@gmail.com",
            	"contrasena": "123456",
            	"tipoUsuario": "USUARIO"
            }
        headers:
          - name: Content-Type
            value: application/json
        settings:
          renderRequestBody: true
          encodeUrl: true
          followRedirects: global
          cookies:
            send: true
            store: true
          rebuildPath: true
      - url: "{{ base_url }}/api/auth/login"
        name: Login
        meta:
          id: req_bf0a2683970f410fbb3b735ec45b7e60
          created: 1701600000000
          modified: 1701600000000
          isPrivate: false
          description: Devuelve el token JWT. Copia el token de la respuesta a la variable
            de entorno 'token'.
          sortKey: -90
        method: POST
        body:
          mimeType: application/json
          text: |-
            {
            	"correoElectronico": "javi@gmail.com",
            	"contrasena": "123456"
            }
        headers:
          - name: Content-Type
            value: application/json
        settings:
          renderRequestBody: true
          encodeUrl: true
          followRedirects: global
          cookies:
            send: true
            store: true
          rebuildPath: true
  - name: 2. Seguros
    meta:
      id: fld_a5ed6325bb4f415b8acc808f3c800217
      created: 1764837783637
      modified: 1764837783637
      sortKey: -1764837783637
      description: ""
    children:
      - url: "{{ base_url }}/api/seguros/ins-001"
        name: Detalle Seguro
        meta:
          id: req_3725316e5f9542c3b28f5434cfc55233
          created: 1701600000000
          modified: 1701600000000
          isPrivate: false
          description: ""
          sortKey: -90
        method: GET
        settings:
          renderRequestBody: true
          encodeUrl: true
          followRedirects: global
          cookies:
            send: true
            store: true
          rebuildPath: true
      - url: "{{ base_url }}/api/seguros"
        name: Listar Seguros
        meta:
          id: req_bc90b5b845fd443e9a7e0b28394265d2
          created: 1701600000000
          modified: 1701600000000
          isPrivate: false
          description: ""
          sortKey: -100
        method: GET
        parameters:
          - name: busqueda
            value: viaje
            disabled: true
          - name: categoria
            value: Viaje
            disabled: true
        settings:
          renderRequestBody: true
          encodeUrl: true
          followRedirects: global
          cookies:
            send: true
            store: true
          rebuildPath: true
  - name: 3. Checkout
    meta:
      id: fld_8c4cbde5bbc84a52be2b6558ee02ca8f
      created: 1764837783638
      modified: 1764837783638
      sortKey: -1764837783638
      description: ""
    children:
      - url: "{{ base_url }}/api/ordenes/checkout"
        name: Checkout (Compra)
        meta:
          id: req_0c16a3b8a4244d1eb8235c3c895c699a
          created: 1701600000000
          modified: 1701600000000
          isPrivate: false
          description: ""
          sortKey: -100
        method: POST
        body:
          mimeType: application/json
          text: |-
            {
            	"items": [
            		{
            			"seguroId": "ins-001",
            			"cantidad": 1,
            			"duracion": 7
            		}
            	],
            	"metodoPago": {
            		"numeroTarjeta": "1234567890123456",
            		"nombreTarjeta": "JUAN PEREZ",
            		"fechaVencimiento": "12/30",
            		"cvv": "123"
            	}
            }
        headers:
          - name: Content-Type
            value: application/json
          - name: Authorization
            value: Bearer {{ token }}
        settings:
          renderRequestBody: true
          encodeUrl: true
          followRedirects: global
          cookies:
            send: true
            store: true
          rebuildPath: true
  - name: 4. Pólizas
    meta:
      id: fld_4ae27471a5964853bb39707c38ba06a4
      created: 1764837783639
      modified: 1764837783639
      sortKey: -1764837783639
      description: ""
    children:
      - url: "{{ base_url }}/api/polizas/pol-001/cancelar"
        name: Cancelar Póliza
        meta:
          id: req_62977d9073cd4953bc57b9e808372ee8
          created: 1701600000000
          modified: 1701600000000
          isPrivate: false
          description: ""
          sortKey: -90
        method: PUT
        headers:
          - name: Authorization
            value: Bearer {{ token }}
        settings:
          renderRequestBody: true
          encodeUrl: true
          followRedirects: global
          cookies:
            send: true
            store: true
          rebuildPath: true
      - url: "{{ base_url }}/api/polizas/usuario/user-001"
        name: Mis Pólizas
        meta:
          id: req_e9e05e448228468391e67ed57d036045
          created: 1701600000000
          modified: 1701600000000
          isPrivate: false
          description: ""
          sortKey: -100
        method: GET
        headers:
          - name: Authorization
            value: Bearer {{ token }}
        settings:
          renderRequestBody: true
          encodeUrl: true
          followRedirects: global
          cookies:
            send: true
            store: true
          rebuildPath: true
  - name: 5. Admin & Usuarios
    meta:
      id: fld_3f94870b71204055b40366b1ac14bc24
      created: 1764837783640
      modified: 1764837783640
      sortKey: -1764837783640
      description: ""
    children:
      - url: "{{ base_url }}/api/usuarios/1"
        name: Eliminar Usuario (Admin)
        meta:
          id: req_25ca027e4ebe4e609acecb3e5f37f7f3
          created: 1701600000000
          modified: 1701600000000
          isPrivate: false
          description: Verifica relaciones antes de borrar
          sortKey: -90
        method: DELETE
        headers:
          - name: Authorization
            value: Bearer {{ token }}
        settings:
          renderRequestBody: true
          encodeUrl: true
          followRedirects: global
          cookies:
            send: true
            store: true
          rebuildPath: true
      - url: "{{ base_url }}/api/usuarios"
        name: Listar Usuarios (Admin)
        meta:
          id: req_6b8eb228bfb1408280319d21e165e68f
          created: 1701600000000
          modified: 1765284870306
          isPrivate: false
          description: ""
          sortKey: -100
        method: GET
        parameters:
          - name: busqueda
            value: ""
          - name: tipoUsuario
            value: TODOS
        headers:
          - name: Authorization
            value: Bearer {{ token }}
        authentication:
          type: bearer
          token: eyJhbGciOiJIUzI1NiJ9.eyJyb2wiOiJVU1VBUklPIiwic3ViIjoiamF2aUBnbWFpbC5jb20iLCJpYXQiOjE3NjUyODQ4NTUsImV4cCI6MTc2NTM3MTI1NX0.ErSKiPi9zIp9a0g2f5FRpG2r9KDB-GmIk4oIwYxFhCA
        settings:
          renderRequestBody: true
          encodeUrl: true
          followRedirects: global
          cookies:
            send: true
            store: true
          rebuildPath: true
      - url: http://localhost:8080/api/usuarios/1
        name: Actualizar Usuarios
        meta:
          id: req_75b9cab5e09d47be99830ad11ecb693e
          created: 1765285762410
          modified: 1765286294867
          isPrivate: false
          description: ""
          sortKey: -1765285762410
        method: PUT
        body:
          mimeType: application/json
          text: |-
            {
            		"rol": "ADMIN"
            	}
        headers:
          - name: Content-Type
            value: application/json
          - name: User-Agent
            value: insomnia/12.1.0
            description: ""
            disabled: false
        authentication:
          type: bearer
          token: eyJhbGciOiJIUzI1NiJ9.eyJyb2wiOiJVU1VBUklPIiwic3ViIjoiamF2aUBnbWFpbC5jb20iLCJpYXQiOjE3NjUyODQ4NTUsImV4cCI6MTc2NTM3MTI1NX0.ErSKiPi9zIp9a0g2f5FRpG2r9KDB-GmIk4oIwYxFhCA
        settings:
          renderRequestBody: true
          encodeUrl: true
          followRedirects: global
          cookies:
            send: true
            store: true
          rebuildPath: true
  - name: 6. RGPD & Reportes
    meta:
      id: fld_d67eb6e37ed54d40bde1ebbd130d6795
      created: 1764837783641
      modified: 1764837783641
      sortKey: -1764837783641
      description: ""
    children:
      - url: "{{ base_url }}/api/cookies/consentimiento/1"
        name: 2. Ver Consentimiento
        meta:
          id: req_13f6d080a27b4cdb90d865f0424d79e9
          created: 1701600000000
          modified: 1701600000000
          isPrivate: false
          description: ""
          sortKey: -95
        method: GET
        settings:
          renderRequestBody: true
          encodeUrl: true
          followRedirects: global
          cookies:
            send: true
            store: true
          rebuildPath: true
      - url: "{{ base_url }}/api/derechos/solicitar-portabilidad"
        name: 5. Solicitar Portabilidad
        meta:
          id: req_57de14368114400d9d730f7c3276053f
          created: 1701600000000
          modified: 1701600000000
          isPrivate: false
          description: Derecho a la Portabilidad Art. 20 RGPD
          sortKey: -70
        method: POST
        body:
          mimeType: application/json
          text: |-
            {
            	"usuarioId": 1
            }
        headers:
          - name: Content-Type
            value: application/json
          - name: Authorization
            value: Bearer {{ token }}
        settings:
          renderRequestBody: true
          encodeUrl: true
          followRedirects: global
          cookies:
            send: true
            store: true
          rebuildPath: true
      - url: "{{ base_url }}/api/cookies/consentimiento"
        name: 1. Guardar Consentimiento Cookies
        meta:
          id: req_58283c2769b04d7ebbdc3a08d5fa6730
          created: 1701600000000
          modified: 1701600000000
          isPrivate: false
          description: ""
          sortKey: -100
        method: POST
        body:
          mimeType: application/json
          text: |-
            {
            	"usuarioId": 1,
            	"cookiesAnaliticas": true,
            	"cookiesMarketing": false
            }
        headers:
          - name: Content-Type
            value: application/json
        settings:
          renderRequestBody: true
          encodeUrl: true
          followRedirects: global
          cookies:
            send: true
            store: true
          rebuildPath: true
      - url: "{{ base_url }}/api/derechos/solicitar-supresion"
        name: 6. Solicitar Supresión
        meta:
          id: req_62bcafa180c34df4951b9ca12c8fb37a
          created: 1701600000000
          modified: 1701600000000
          isPrivate: false
          description: Derecho al Olvido Art. 17 RGPD
          sortKey: -60
        method: POST
        body:
          mimeType: application/json
          text: |-
            {
            	"usuarioId": 1,
            	"descripcion": "Ya no deseo usar el servicio"
            }
        headers:
          - name: Content-Type
            value: application/json
          - name: Authorization
            value: Bearer {{ token }}
        settings:
          renderRequestBody: true
          encodeUrl: true
          followRedirects: global
          cookies:
            send: true
            store: true
          rebuildPath: true
      - url: "{{ base_url }}/api/derechos/solicitar-acceso"
        name: 3. Solicitar Acceso (RGPD)
        meta:
          id: req_ba67192c3fec41dca4bf5c1f17e5351a
          created: 1701600000000
          modified: 1701600000000
          isPrivate: false
          description: Derecho de Acceso Art. 15 RGPD
          sortKey: -90
        method: POST
        body:
          mimeType: application/json
          text: |-
            {
            	"usuarioId": 1
            }
        headers:
          - name: Content-Type
            value: application/json
          - name: Authorization
            value: Bearer {{ token }}
        settings:
          renderRequestBody: true
          encodeUrl: true
          followRedirects: global
          cookies:
            send: true
            store: true
          rebuildPath: true
      - url: "{{ base_url }}/api/derechos/mis-solicitudes/1"
        name: 7. Ver Mis Solicitudes
        meta:
          id: req_cc3b7047342f455685839a932ab408af
          created: 1701600000000
          modified: 1701600000000
          isPrivate: false
          description: Listar historial de solicitudes RGPD
          sortKey: -50
        method: GET
        headers:
          - name: Authorization
            value: Bearer {{ token }}
        settings:
          renderRequestBody: true
          encodeUrl: true
          followRedirects: global
          cookies:
            send: true
            store: true
          rebuildPath: true
      - url: "{{ base_url }}/api/derechos/solicitar-rectificacion"
        name: 4. Solicitar Rectificación
        meta:
          id: req_ec1ee0f808604eb6a553bd92765fa6ce
          created: 1701600000000
          modified: 1701600000000
          isPrivate: false
          description: Derecho de Rectificación Art. 16 RGPD
          sortKey: -80
        method: POST
        body:
          mimeType: application/json
          text: |-
            {
            	"usuarioId": 1,
            	"descripcion": "Cambio de dirección a Calle Falsa 123"
            }
        headers:
          - name: Content-Type
            value: application/json
          - name: Authorization
            value: Bearer {{ token }}
        settings:
          renderRequestBody: true
          encodeUrl: true
          followRedirects: global
          cookies:
            send: true
            store: true
          rebuildPath: true
cookieJar:
  name: Default Jar
  meta:
    id: jar_11dc2422c35d58f9990c83fda7cd76a660efdf3a
    created: 1764837785401
    modified: 1764837785401
environments:
  name: Base Environment
  meta:
    id: env_831bda4d82a1415999678d4faa324209
    created: 1764837783643
    modified: 1765284964699
    isPrivate: false
  data:
    base_url: http://localhost:8080
    token: eyJhbGciOiJIUzI1NiJ9.eyJyb2wiOiJVU1VBUklPIiwic3ViIjoiamF2aUBnbWFpbC5jb20iLCJpYXQiOjE3NjUyODQ4NTUsImV4cCI6MTc2NTM3MTI1NX0.ErSKiPi9zIp9a0g2f5FRpG2r9KDB-GmIk4oIwYxFhCA
